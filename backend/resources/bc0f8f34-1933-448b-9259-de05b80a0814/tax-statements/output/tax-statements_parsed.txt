<a id='ba3bb6ee-c927-4aae-8a53-33c2b96631dc'></a>

CAPTURING DEMAND TRANSFERENCE IN RETAIL - A STATISTICAL APPROACH

<a id='30f14752-1634-4e18-84d6-a86cd0372818'></a>

**Omker Mahalanobish**
Statistical Analyst, Walmart Labs, Bengaluru, India
omker.mahalanobish@walmart.com

<a id='a0641ab8-977f-4e4c-99ac-08c6ca2173b2'></a>

**Souraj Mishra**
Statistical Analyst, Walmart Labs, Bengaluru, India
souraj.mishra@walmart.com

<a id='aa4225cf-2615-4e16-9067-0ebf89ae709a'></a>

**Amlan Das**
Statistical Analyst, Walmart Labs, Bengaluru, India
amlan.das@walmart.com

<a id='cbb5283e-a232-407e-8ddc-fa9747f4cdf7'></a>

Subhasish Misra*
Associate Data Scientist, Walmart Labs, Bengaluru, India
subhasish.misra@walmart.com

<a id='8effed23-6508-4932-8b9a-991596514c9a'></a>

## Background:

While an item substitution measure provides for the direction, **demand transference** quantifies the magnitude of demand that may get transferred to an item a) When its substitute is deleted b) When it is introduced in a store and cannibalizes on similar items.

<a id='ba8d3a61-acf1-4f37-9780-88a05cabb035'></a>

This, hence, is an important input into assortment optimization. If an item is predicted to exhibit a good extent of transference **then we may be more certain of deleting it** (provided, it is less than an average performer in terms of sales). Conversely, we should be careful of deleting a very incremental item (with low demand transference) – since we'll be losing on a bulk of its demand.

<a id='c290d89a-ff5e-4e56-8803-7cfdc94e1643'></a>

Note that transference is not explicitly observed, it's latent. Our methodology explains how we capture it.

<a id='237ecedf-c439-46a7-a9a5-3e638f48654e'></a>

**Method:**
**Data:** POS, promotions & item attribute data is harnessed for this process.

<a id='c9ac931b-3056-4738-99e9-7a90b320aff3'></a>

## Modeling:

* Regression models (in a longitudinal setup) are used to estimate demand for an item – among other explanatory variables we have one that accounts for cannibalization effect of similar items.
* The cannibalization term uses the attribute data to calculate item similarity. Its value changes depending on presence/absence of similar items and is the instrument through which demand transference seeps into this model.

<a id='4850e424-8ca2-4b64-93a9-24be4fe6f7a1'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='f40103dd-e5dc-44fa-b755-a94bdaa7b12e'></a>

- The modeling process is designed to automatically take care of complications such as multicollinearity and sundry regression violations.
- Since each store is unique in terms of the consumer demand pattern these models have been estimated at a store x substitutable community level.
- This means that for a category with 10 + substitutable community, we are estimating 10 * 4000 + = 40000 + models using parallelization techniques in Hadoop.

<a id='3300bfe6-039a-4eea-84ae-2e61229692f3'></a>

In conclusion, these models predict the extent of transference (i.e. if an item "i₁" in the pre-delete scenario was selling 100 units, then what amount of its demand would get transferred to its substitutes, say, "i₂", "i₃", "i₄"). All this, at an individual store level as well as the overall US.

<a id='25210592-c0b5-4b18-a692-c7898d04c42e'></a>

**Expected outcome:**

The methodology has been successfully tested for multiple foods and consumable categories, as well as general merchandising categories in the US – efforts are on towards making this one of the processes of estimating demand transference. The entire process, despite involving sophisticated modeling has been **scaled (across all stores)**, **automated and productized** as an easy to use manner for the business user.

<a id='7c389668-ddde-4643-a6d0-121c1c6683ef'></a>

**Keywords:** *Regression, Cannibalization, Retail, Parallelization, Forecasting*

<a id='102a9fc8-4164-4312-9439-6917eb6cbb7b'></a>

# 1. INTRODUCTION
Assortment is a key element of a retailer's marketing mix. It differentiates a retailer from its competitors and has a very strong influence on retail sales. Retailers face the problem of selecting the assortment that maximizes category profitability, without sacrificing customer satisfaction.

<a id='59bdc406-833a-45a9-9f08-614bf4f5af4f'></a>

Although some headway has been made in the context of assortment optimization, practitioners and academics agree that more research is needed to provide feasible solutions to realistic assortment problems. Specifically, the challenge of assortment optimization is compounded by the fact that the demand for an item cannot be assumed to be fixed; it is instead affected by the presence of other items as a result of product substitution.

<a id='09c46a34-0775-473c-b9aa-0ee87e8cae57'></a>

One of the important challenge is to account for similarity effects: an item is a stronger substitute for similar items than it is for dissimilar items. Demand is also driven by own- and cross-marketing mix instruments such as price, promotion and by heterogeneous preference across stores. Capturing these aspects in a response model is further complicated by the fact that assortments and prices observed in empirical data are unlikely to be exogenous. Finally, retailers have to decide about not only the assortment, but also about the pricing, and these decisions need to be customized at a store level.

<a id='1cc31644-7670-4fb5-accf-8a2dea2e132a'></a>

In the process of optimizing the store assortment, it is important to understand the process of demand transference. Demand transference is defined as the process of transfer of demand among the items in a store, once a change in assortment is realized.

<a id='4b38e2c8-1607-4579-9f65-e5f62a94eb2c'></a>

In a store, for a given category, there may be two realizations of an assortment change :
1. When one or more items are dropped from the assortment, customers who intended to buy any of the dropped items, might either choose to opt for another 'substitutable' item or walk away from the store, without a purchase.

<a id='71bd57b4-c049-4c69-aeff-4f4dd9fa34a4'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='8c79bd5c-a188-4d04-b46a-cb8a35637845'></a>

2. When one or more items are introduced into the assortment, customers who purchased any of the new items, might either buy the new item out of impulse or replace purchasing an existing item with the new item.

<a id='7633bdeb-0b1c-4fad-8b97-7a0b24f6630e'></a>

A better understanding of this underlying process would help in identifying the optimum assortment for the particular category in the particular store. In this paper, we aim to model the mechanism of demand transference so as to optimize the store assortment, for the category.

<a id='148123e1-6492-42ad-bdda-bc2341865383'></a>

## 2. LITERATURE REVIEW
This section briefly discusses about the studies in place related to assortment selection / optimization.

<a id='43a24edf-ade4-4ffa-8cb9-f4937fe5a486'></a>

The common points among the available literatures is that they all look to optimize the assortment, based on maximizing cost function (usually sales or profit). We here would only restrict ourselves towards those studies which deal with the item attributes along with the scanner data.

<a id='af07a888-d36c-4e35-85bb-47ef9605ff71'></a>

Among the available articles, Fisher and Vaidyanathan (Fisher et al., 2009) look into selecting the optimum number of items from the available lot, to maximize sales. They have defined an approach, in which they view a item as a set of attribute values, use sales history of the items currently carried by the retailer to estimate the demand for each of the attribute values and from this, the demand for any potential item currently not carried by the retailer. They also introduce a model of substitution behavior, estimate the parameters and consider the impact of substitution in choosing assortment.

<a id='b8ca84c6-a770-4de7-8024-225aa87650bc'></a>

Kök and Fisher (2007), also tread similar lines wherein they study an assortment planning model in which consumers might accept substitutes when their favorite product is unavailable. They develop an algorithmic process to help retailers compute the best assortment for each store, by estimating the parameters of substitution behavior and demand for products at a store, including products that have not been carried previously in that store. Finally, they propose an iterative optimization heuristic to solve the assortment planning problem.

<a id='fbd67587-4666-46bb-bab7-c9a483b2f164'></a>

Other articles like Rooderkerk et al., (2013) look into price optimization along with promotion and shelf space optimization. Herein, they adopt a scalable assortment optimization method that allow for theory based substitution patterns and cross marketing mix effects. For the optimization part, they propose a large neighborhood search heuristic methodology.

<a id='3df57f38-3f01-488d-a80e-41767aeb7903'></a>

Our study though on similar lines, addresses an entirely different aspect of assortment study. This is more of scenario based, to understand how the store assortment performs when a change in the store assortment is realized. Basically, we help the retailer to decide which items to drop from the assortment, by helping him understand where the demand of the deleted item would flow to and in what magnitude. The retailer also gets a glimpse of additional incremental demand as well as the magnitude and direction of cannibalization that might be realized when additional items are added to the assortment. In the process of obtaining these insights, he also gets an understanding as to how the items in the new assortment will perform in the future.

<a id='009422b3-9e39-4426-bbb0-0bd8493c184c'></a>

### 3. METHODOLOGY
Demand is a latent feature, which can be experienced but not explicitly observed. Thus, modeling of demand and validation of the same becomes difficult. The nearest proxy to demand is sales. So, here we try to model the sales of each of the products offered in an assortment.

<a id='8e4e9bcf-f77a-464d-94da-5b6b5858497c'></a>

Our methodology consists of a sales model, described in section 3.1 and a predictive algorithm based on the sales model, as described in section 3.2.

<a id='73528492-d998-44c1-92eb-e23396525636'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='1ad4be34-5ab1-4878-ba20-aa149e60e2b6'></a>

### 3.1. Sales model

Before formulating the model, we look at a significant challenge encountered while developing the sales model: modeling store level UPC sales on attributes. UPC (Universal Product Code) is used to identify trade items in stores across different retailers and markets. UPC is aggregation of items which can vary across different regions.

<a id='814f494f-37b9-4c28-9fda-5032938eacfa'></a>

### 3.1.1. Modeling framework
To model UPC sales at a store level, we chose store-level scanner data, as it provides a holistic view of the available assortment in the store. An example of the input data is provided in Table 1 under section 4.1. Our approach of modeling UPC sales on UPC attributes is motivated by the assertion that customers do not form preference of each individual UPC in a product category but that these preferences are derived from the preferences for the underlying attributes (e.g., size, brand, flavor, etc.). Theoretical justification of the same is available in economics (Lancaster, 1971) and psychology (Fishbein, 1967).

<a id='7e17ff28-714f-45af-be6b-cbfcaf88de84'></a>

Our model thus takes into account the UPC attributes, in order to model UPC sales. Apart from the UPCs own attributes, attributes of other available UPCs would also affect the sales. We thus incorporate variables to account for a UPCs attribute similarity as well as cross attribute similarity with the other UPCs in the assortment.

<a id='c5feacb6-b2c4-49ad-ba69-a9100118b2b9'></a>

### 3.1.2. Modeling formulation
We would now develop the attribute based model and highlight the role similarity variables play. While modeling UPC sales at a store level, we allow for flexible substitution patterns, and non-linear effects by starting with a log-log model (Rooderkerk et al., 2013), similar to the SCAN*PRO model (Wittink et al., 1988):

log($S_{kti}$) = $\underbrace{\alpha_{ki}}_{A}$ + $\underbrace{\beta.log(P_{kti})}_{B}$ + $\underbrace{\sum_{m \in A} \gamma_{kmti}}_{C}$ (1)

<a id='b4e0597e-dd01-4d3f-b091-ad1a67b07b00'></a>

where,

$S_{kti}$ = unit sales of UPC $k \in \{1, 2, ..., K\}$ in week $t \in \{1, 2, ..., T\}$ in store $i \in \{1, 2, ..., n\}$;

$\alpha_{ki}$ = UPC-store intercept for UPC $k \in \{1, 2, ..., K\}$ in store $i \in \{1, 2, ..., n\}$;

$P_{kti}$ = price of UPC $k \in \{1, 2, ..., K\}$ in week $t \in \{1, 2, ..., T\}$ in store $i \in \{1, 2, ..., n\}$;

$\gamma_{kmti}$ = similarity score of UPC $k \in \{1, 2, ..., K\}$, for attribute $m \in \mathcal{A}$, in week $t \in \{1, 2, ..., T\}$ in store $i \in \{1, 2, ..., n\}$;

$\mathcal{A}$ = set of all attributes, evaluated for all UPCs in a product category;

<a id='855c58a9-4176-4c44-bcc9-23b7e1a484e3'></a>

Further, $\alpha_{ki}$ may be replaced by strictly store level intercepts along with attribute dummies such that

$\alpha_{ki} = \underbrace{\alpha_i}_{A} + \underbrace{\sum_{m \in A} \sum_{l=1}^{m_l} A_{kml}}_{B}$ (2)

<a id='077fea9d-737a-48cb-90ec-4e36bdbfee5f'></a>

where,

&nbsp;&nbsp;&nbsp;&nbsp;A_kml = 1 if UPC k possesses level l of attribute m ∈ A, and 0 otherwise, if m is nominal

&nbsp;&nbsp;&nbsp;&nbsp;A_kml = the realization of attribute m ∈ A, if m is metric

<a id='2ad2e946-420e-4eb9-856d-5125f7f78582'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753
Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='eb04ab88-3b6a-4f82-aad4-c014f298f040'></a>

### 3.1.3. Attribute similarity score
The similarity score of UPC _k_, for a nominal or metric attribute _m_, in week _t_, in store _i_ is defined such that it varies between 0 (minimum similarity) and 1 (maximum similarity), and also reflects the similarity of UPC _k_ relative to the distribution of attribute _m_ in the entire available assortment.

<a id='f114ad7b-d900-45ea-b8c4-61312592d9c9'></a>

Let $SIM_{kk'mti}$ denote the magnitude of similarity between UPC $k$ and UPC $k'$ with respect to attribute $m$ in store $i$ in week $t$.

<a id='81841d2b-ba5d-4ab2-9742-6b4133e4bfe8'></a>

Further to the above discussed features of similarity, if UPC k and UPC k' share the same level of nominal attribute m, then the perceived similarity of UPC k and UPC k' should be stronger when their shared attribute level occurs less frequently (Goodall, 1966). We obtain all the above, by defining :

<a id='9c3b01f3-699d-4dc4-b43f-57322ce05fd7'></a>

$$SIM_{kk'mti} = I\{A_{k'm} = A_{km}\}. \left(1 - \frac{1}{N_{ti}} \sum_{k''=1, x_{k''ti}=1}^{K} I\{A_{k''m} = A_{km}\} \right) \quad (3a)$$

<a id='05b3dc07-c797-42c1-96c4-9a60c31be93b'></a>

if attribute _m_ is nominal, where,

I{·} = an indicator function which takes the value 1 if its argument holds, 0 otherwise;

_A_<sub>_km_</sub> = the level attained by UPC _k_ on attribute _m_ such that _A_<sub>_km_</sub> = _l_ ⇔ _A_<sub>_kml_</sub> = 1;

_N_<sub>_ti_</sub> = the number of UPCs present in week _t_ in store _i_;

_x_<sub>_kti_</sub> = 1, if UPC _k_ was available in store _i_, for at least 1 day in week _t_; else 0.

<a id='6a1a621f-42ed-4b64-8947-f988ef3bc440'></a>

Table 3 in section 4.2 illustrates how this would work for a Brand attribute.

<a id='ca0c3a58-151e-434e-9eb5-fea8fe521edc'></a>

On the other hand, the similarity of UPC k and UPC k', with respect to a metric attribute m, is perceived to be more if there exists fewer UPCs with attribute values between the attribute values of UPC k and UPC k'. This is obtained by defining:

<a id='395f880c-a360-458e-8108-996b04690e47'></a>

$$SIM_{kk'mti} = 1 - \frac{1}{N_{ti}} \cdot \sum_{\substack{k''=1 \\ x_{k''ti}=1}}^{K} I\{\min(A_{km}, A_{k'm}) \leq A_{k''m} \leq \max(A_{km}, A_{k'm})\} \quad (3b)$$

<a id='3106512d-18cd-42ed-bc98-2cf8d34697e9'></a>

if attribute _m_ is metric.
This definition is numerically illustrated for Weight attribute in Table 5 in section 4.2.

<a id='528835ef-3181-409c-a013-c2f3e24dd759'></a>

Once we have described the measure of similarity for UPC k and UPC k', we may now formulate the similarity score of UPC k for attribute m in week t in store i as:

$\gamma_{kmti} = mean^*_{k'\neq k} (SIM_{kk'mti})$

(4)

<a id='163baee3-1174-4bda-b4b7-85ec79b81aea'></a>

where,
$mean^*(.) = \text{Arithmetic Mean of the non-zero elements of the argument, if attribute } m \text{ is}$
nominal, usual Arithmetic Mean otherwise.

<a id='c30c3d22-eef5-44a7-ad10-c22555267136'></a>

### 3.1.4. Model implementation
The model described in this paper, is best implemented when modeled category wise. Now, each category has properties of its own and consists of widely different varieties of UPCs. The two major category properties that is observed is as follows:

<a id='3250f1a2-975f-453c-8e57-ed1f628c56ab'></a>

1. Demand might get transferred to any and every UPC of the category and

<a id='600fb3d1-8b51-4052-842e-36162c233859'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753
Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='81ee9017-c792-4933-ae19-2a849f61aacd'></a>

2. Transfer of demand is restricted only within mutually exclusive and exhaustive set of substitutable groups, which are very different from each other (further discussed in section 4.3).

<a id='4dd12574-16ff-4d06-a27c-c1493f668bf9'></a>

For case 2, one may carry on the same analysis over each substitutable group, as if assuming it to be a small sized category of sorts.

<a id='ae911a5f-0950-4213-9ce2-a18218bfc163'></a>

Since we have formulated a linear regression as mentioned in (1), all regression sanity checks have been taken care of and the final model thus only consists of the uncorrelated and significant regressors among the ones mentioned in (1).

<a id='65f6c0f1-8bea-4bd3-9be9-ee0e208db55f'></a>

## 3.2. Predictive algorithm
We would now look into how to predict the magnitude of demand transference and the walkoff rate.
Define

<a id='f8986d80-ba63-4e3b-9a17-8db36e6213fa'></a>

A_i : the training assortment of store i;
A'_i : the assortment of store i after the assortment change;

<a id='a6e48fb2-67f1-4fb9-b518-0f2b4351ce10'></a>

Now, for every UPC in A_t, we can easily obtain the predicted weekly unit sales from the model as explained in (1).

<a id='bfb3f7a3-235b-4ab9-94dd-77d690a90512'></a>

Also, the values of parts A and B in (1) are independent of the store assortment (assuming there is no change in price in any of the items in Aᵢ) and thus doesn't change. It suffices to compute these values only for those UPCs that have been introduced in A'ᵢ but were not a part of Aᵢ. Part C in (1) directly depends upon the current assortment in store and hence the similarity score is recalculated for each UPC in the new assortment. Once we have all the required information, the predicted weekly unit sales of every UPC in Aᵢ can be easily obtained.

<a id='b677dbb8-7b66-4964-b21e-be0ddbb6d168'></a>

Define,

$\hat{S}_{ki}$ = predicted weekly unit sales of UPC $k \in A_i$;

$\hat{S}'_{ki}$ = predicted weekly unit sales of UPC $k \in A'_i$;

<a id='1fe31182-1097-4395-a31c-afe50b105767'></a>

Therefore,

<a id='633e1f0b-823d-4396-a88d-f23c3ccb246b'></a>

$\Delta S_{ki} = \hat{S}'_{ki} - \hat{S}_{ki}$, is the change in the weekly unit sales of UPC $k \in A_i \cap A'_i$.
But, $\Delta S_{ki} = \hat{S}'_{ki}$, if UPC $k \in A'_i \setminus A_i$

<a id='ad61f4f7-8750-4f55-b077-8253ff57bc49'></a>

### 3.2.1. Case of item deletion
Define $U_{del}$ = set of UPCs that have been deleted from $A_i$, and are not present in $A'_i$. Then,

<a id='eaf9ee3c-08a0-4b07-b3f0-68cc4d24e46f'></a>

$\Delta_{kA'i}^{del} = \frac{\Delta S_{ki}}{\sum_{t \in u_{del}} \hat{S}_{ti}} . 100 \%$ (5a)

<a id='1fa796d4-402e-4ae5-a150-0c46e3360c6c'></a>

where,

<a id='0710f33b-ef0f-4b0c-a3e6-30f7bbcbdaf2'></a>

$\Delta_{kA'_i}^{del}$ = demand of UPCs in $U_{del}$ transferred to UPC $k$, $\forall k \in A'_i$.

<a id='9461244b-d3ce-4aaa-a5f3-e2611b0a964c'></a>

Herein, the walk-off rate is calculated as:
$ω_{A'_i}^{del} = 100 - \sum_{k \in A'_i} Δ_{kA'_i}^{del}$ (5b)

<a id='1d056e39-807c-46dc-aa74-8f48183587b1'></a>

### 3.2.2. Case of item addition
Define, U_add = set of UPCs that have been added to A'_i, but were not a part of A_i. Then,

<a id='eedd3433-02dd-4830-a434-03ece19a0a9d'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='0db34310-3c3b-49bc-a499-aef348fdf15e'></a>

$$\Delta_{k A'_i}^{add} = \frac{|\Delta S_{ki}|}{\sum_{t \in u_{add}} \hat{S}_{ti}'} \cdot 100 \%$$ (6a)

<a id='6b715380-d1c9-4c4d-a1ab-fee07c9ad674'></a>

where,

<a id='5e429879-1f5c-4619-bc9c-360c81e1a698'></a>

$\Delta_{kA'_i}^{add} = \text{demand of UPCs in } U_{add} \text{ cannibalized from UPC } k, \forall k \in A'_i.$

<a id='401350e5-740d-4cd6-8c56-e5808a399183'></a>

Herein, the incrementality is calculated as:

$$\omega_{A'_i}^{add} = 100 - \sum_{k \in A'_i} \Delta_{kA'_i}^{add} \quad (6b)$$

<a id='957ab71b-d684-43d1-ac98-6716bf4bfe3c'></a>

### 3.2.3. Case of both item deletion and item addition
In this case, it becomes difficult to identify separately, what amount of the change in the demand for UPC _k_, is due to the transfer of demand from the deleted UPCs and how much amount is due to cannibalization of the added UPCs. Further, there could even be some amount of demand transference towards the newly added UPCs as well.

<a id='1c1e85b6-c1e7-4c8d-8fbb-3bf8c0b8d618'></a>

Hence, one may separately consider the deletions and additions to obtain the demand transference measures.

<a id='c577cf75-108c-4bb8-87f8-7efd0bdbe76a'></a>

Therefore, we have

<a id='1db29dd6-8600-4ce7-9255-cd39cb397e14'></a>

$$\Delta_{K A'_i}^{add} = \frac{|\Delta S_{ki}| \cdot |\mathcal{U}_{add}|}{|\mathcal{U}_{del}| \cdot \sum_{t \in \mathcal{U}_{add}} \hat{S}_{ti}} \cdot 100 \%, \forall k \in A'_i \quad (7a)$$

<a id='d406bbb5-82d5-4d46-80af-b92a6eaea5ab'></a>

$$\Delta_{kA'i}^{del} = \frac{\Delta S_{ki} \cdot \frac{|U_{del}|}{|U_{add}|}}{\sum_{t \in U_{del}} \hat{S}_{ti}} \cdot 100\%, \quad \forall k \in A'_i \quad (7b)$$

<a id='204d0843-0d4b-4dd6-bdc3-e4cccdbdde39'></a>

where,

$\Delta_{kA'_i}^{add}$ = demand of UPCs in $U_{add}$ cannibalized from UPC $k$, $\forall k \in A'_i$.

$\Delta_{kA'_i}^{del}$ = demand of UPCs in $U_{del}$ transferred to UPC $k$, $\forall k \in A'_i$.

<a id='9de02483-40f2-4f5d-af3d-0ac3078fb930'></a>

In (7b),

$ΔS_{ki} = ΔS_{ki} · (1 - \sum_{t∈\mathcal{U}_{add}} \frac{Δ_{tA^i}^{add}}{100} · I\{k ∈ \mathcal{U}_{add}\})$ (7c)

<a id='50e9a2f0-ba9a-4464-b1f7-3ef7d5c7dd9e'></a>

Therefore, walkoff rate is:

$\omega_{A'_i}^{del} = 100 - \sum_{k \in A'_i} \Delta_{kA'_i}^{del}$

(7d)

<a id='80b22b23-fef5-4dbe-9a10-73f91dd8fb69'></a>

and incrementality is defined as:

<a id='a1aa00ae-815f-4f85-a986-8a44d02c6928'></a>

$$\omega_{A'_i}^{add} = 100 - \sum_{k \in A'_i} \Delta_{kA'_i}^{add} - \sum_{k \in \mathcal{U}_{add}} \Delta_{kA'_i}^{del} \quad (7e)$$

<a id='725e8e44-1a55-490d-a615-b460fc54d4be'></a>

4. DISCUSSION

<a id='7bf6f9e2-3aa0-42e7-b164-fc43b137a4a1'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753
Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='b28b937f-e6fe-4812-8e88-ff6291940d4f'></a>

Here, we will have a brief walkthrough of a sample input data for the algorithm along with the similarity calculation for the same.

<a id='3d469158-42c6-426f-b7f1-aa4178b6bd30'></a>

## 4.1. Scanner data and attribute data
Table 1 refers to a snapshot of the scanner data that we require to carry on with the analysis.
The snapshot here has been restricted to 4 UPCs, in 3 weeks and 1 store.

<a id='e75494be-cfdf-4eaf-885b-c027779c1f7b'></a>

Table 1 Snapshot of the scanner data
<table id="7-1">
<tr><td id="7-2">Store No.</td><td id="7-3">UPC</td><td id="7-4">Week No.</td><td id="7-5">Units sold</td><td id="7-6">Dollar Sales</td><td id="7-7">Price</td><td id="7-8">Days available</td></tr>
<tr><td id="7-9">1</td><td id="7-a">UPC 1</td><td id="7-b">1</td><td id="7-c">2</td><td id="7-d">2.40</td><td id="7-e">1.20</td><td id="7-f">7</td></tr>
<tr><td id="7-g">1</td><td id="7-h">UPC 1</td><td id="7-i">2</td><td id="7-j">3</td><td id="7-k">3.55</td><td id="7-l">1.18</td><td id="7-m">7</td></tr>
<tr><td id="7-n">1</td><td id="7-o">UPC 1</td><td id="7-p">3</td><td id="7-q">2</td><td id="7-r">2.40</td><td id="7-s">1.20</td><td id="7-t">7</td></tr>
<tr><td id="7-u">1</td><td id="7-v">UPC 2</td><td id="7-w">1</td><td id="7-x">6</td><td id="7-y">4.50</td><td id="7-z">0.75</td><td id="7-A">6</td></tr>
<tr><td id="7-B">1</td><td id="7-C">UPC 2</td><td id="7-D">2</td><td id="7-E">7</td><td id="7-F">5.25</td><td id="7-G">0.75</td><td id="7-H">7</td></tr>
<tr><td id="7-I">1</td><td id="7-J">UPC 2</td><td id="7-K">3</td><td id="7-L">2</td><td id="7-M">1.60</td><td id="7-N">0.80</td><td id="7-O">7</td></tr>
<tr><td id="7-P">1</td><td id="7-Q">UPC 3</td><td id="7-R">1</td><td id="7-S">0</td><td id="7-T">0.00</td><td id="7-U"></td><td id="7-V">0</td></tr>
<tr><td id="7-W">1</td><td id="7-X">UPC 3</td><td id="7-Y">2</td><td id="7-Z">3</td><td id="7-10">4.50</td><td id="7-11">1.50</td><td id="7-12">3</td></tr>
<tr><td id="7-13">1</td><td id="7-14">UPC 3</td><td id="7-15">3</td><td id="7-16">1</td><td id="7-17">1.50</td><td id="7-18">1.50</td><td id="7-19">4</td></tr>
<tr><td id="7-1a">1</td><td id="7-1b">UPC 4</td><td id="7-1c">1</td><td id="7-1d">10</td><td id="7-1e">6.00</td><td id="7-1f">0.60</td><td id="7-1g">7</td></tr>
<tr><td id="7-1h">1</td><td id="7-1i">UPC 4</td><td id="7-1j">2</td><td id="7-1k">8</td><td id="7-1l">4.80</td><td id="7-1m">0.60</td><td id="7-1n">7</td></tr>
<tr><td id="7-1o">1</td><td id="7-1p">UPC 4</td><td id="7-1q">3</td><td id="7-1r">2</td><td id="7-1s">1.24</td><td id="7-1t">0.62</td><td id="7-1u">2</td></tr>
</table>

<a id='57219b8b-d6b0-4d76-8fda-5a57af364f8e'></a>

Table 2 Attribute information for UPCs in the snapshot
<table id="7-1v">
<tr><td id="7-1w">UPC</td><td id="7-1x">Brand</td><td id="7-1y">Weight (in gm)</td></tr>
<tr><td id="7-1z">UPC 1</td><td id="7-1A">Brand 1</td><td id="7-1B">200</td></tr>
<tr><td id="7-1C">UPC 2</td><td id="7-1D">Brand 1</td><td id="7-1E">180</td></tr>
<tr><td id="7-1F">UPC 3</td><td id="7-1G">Brand 1</td><td id="7-1H">200</td></tr>
<tr><td id="7-1I">UPC 4</td><td id="7-1J">Brand 2</td><td id="7-1K">150</td></tr>
</table>

<a id='46b587f4-9644-48f6-a431-f4f8395b2f3e'></a>

**4.2. Computing the attribute similarity score**
As depicted in Table 2, there are two attributes to take care of viz. Brand (a nominal attribute) and Weight (a metric attribute).

<a id='2581c051-4133-4782-a4fa-d34370812a03'></a>

For attribute Brand, Brand 1 is present in 75% of the overall assortment, whereas Brand 2 is present in 25% of the overall assortment.

<a id='4be97b02-7a0d-485b-935e-996d277a76ef'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='5c802489-4dbd-4728-8c1c-cd1ccd5c280d'></a>

Hence, according to this example, the similarity scores for UPC 1 with respect to the nominal attribute Brand is demonstrated in Table 3 below:

<a id='441bad26-a1e4-4dc9-b4f3-038db3664bc0'></a>

Table 3 Week wise brand similarity score for UPC 1
<table id="8-1">
<tr><td id="8-2">Week No.</td><td id="8-3">Brand 1 presence</td><td id="8-4">Brand similarity score (γkmti)</td></tr>
<tr><td id="8-5">1</td><td id="8-6">66.67%</td><td id="8-7">0.33</td></tr>
<tr><td id="8-8">2</td><td id="8-9">75.00%</td><td id="8-a">0.25</td></tr>
<tr><td id="8-b">3</td><td id="8-c">75.00%</td><td id="8-d">0.25</td></tr>
</table>

<a id='e9e71f19-2c42-4ac4-b59d-330fad52f284'></a>

Similarly, for the metric attribute Weight, similarity score of UPC 1 is seen to be as described in Table 5 below:

<a id='83e8bae1-f08f-4846-82ec-be95c5a08931'></a>

**Table 4** Weekly weight proximity percent for each UPC
<table id="8-e">
<tr><td id="8-f">UPC</td><td id="8-g">Week No.</td><td id="8-h">Weight proximity percent</td><td id="8-i">Weight similarity score</td></tr>
<tr><td id="8-j">UPC 2</td><td id="8-k">1</td><td id="8-l">66.67 %</td><td id="8-m">0.33</td></tr>
<tr><td id="8-n">UPC 2</td><td id="8-o">2</td><td id="8-p">75.00 %</td><td id="8-q">0.25</td></tr>
<tr><td id="8-r">UPC 2</td><td id="8-s">3</td><td id="8-t">75.00 %</td><td id="8-u">0.25</td></tr>
<tr><td id="8-v">UPC 3</td><td id="8-w">1</td><td id="8-x">–</td><td id="8-y">–</td></tr>
<tr><td id="8-z">UPC 3</td><td id="8-A">2</td><td id="8-B">75.00 %</td><td id="8-C">0.25</td></tr>
<tr><td id="8-D">UPC 3</td><td id="8-E">3</td><td id="8-F">75.00 %</td><td id="8-G">0.25</td></tr>
<tr><td id="8-H">UPC 4</td><td id="8-I">1</td><td id="8-J">100.00 %</td><td id="8-K">0.00</td></tr>
<tr><td id="8-L">UPC 4</td><td id="8-M">2</td><td id="8-N">100.00 %</td><td id="8-O">0.00</td></tr>
<tr><td id="8-P">UPC 4</td><td id="8-Q">3</td><td id="8-R">100.00 %</td><td id="8-S">0.00</td></tr>
</table>

<a id='da8e6c1a-8695-4b93-8796-fda71afa4fd7'></a>

Therefore,
<table id="8-T">
<tr><td id="8-U" colspan="2">Table 5 Weekly weight similarity score for UPC 1</td></tr>
<tr><td id="8-V">Week No.</td><td id="8-W">Weight Similarity score</td></tr>
<tr><td id="8-X">1</td><td id="8-Y">0.165</td></tr>
<tr><td id="8-Z">2</td><td id="8-10">0.250</td></tr>
<tr><td id="8-11">3</td><td id="8-12">0.250</td></tr>
</table>

<a id='c370ea43-82fc-43a3-8089-3c9ce9d836b5'></a>

### 4.3. Substitutable groups
A category can be divided into mutually exclusive and exhaustive groups of items, called substitutable groups. A substitutable group consists of items that are more likely to be substitutes of each other, than that of items in the other substitutable groups.

<a id='dcf7da8d-3b0e-4de0-b5f9-d626db56fdf0'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='d6070b34-04db-44c4-8ad0-c28f1ca44dfe'></a>

We accomplish this segmentation into substitutable group by using a proprietary graph partition based algorithm.

<a id='8a769670-0105-4a69-992a-d9221fbfcffd'></a>

When, implemented for a substitutable group, the demand transfer algorithm restricts the transfer of demand within the same group; since by definition, there is very less probability of items in other groups to be proper substitutes.

<a id='94202cb3-3de4-477c-ac2e-1ad29a59e5ca'></a>

## 4.4. Parallelization techniques
The entire algorithm was executed in R, for a category with 7 substitutable groups, available in 4500 stores.

<a id='a4ceef36-7eed-453d-bf6d-63e2c7f2d0cf'></a>

While *Hadoop streaming* was used to execute the algorithm over stores; for a store, the *mclapply* function (which uses forking technique) from *parallel* package was used to parallelize over substitutable groups.

<a id='aaecb19a-c75f-441a-8349-1b09b56be7cc'></a>

For a fixed store, the runtime in R (using forking via _mclapply_) is comparable to the runtime when executed in Python without any scaling up technique.

<a id='902c72ca-120c-42dd-9982-38f90e92319b'></a>

## 4.5. Results and success stories
This algorithm has been run for a variety of categories, both General Merchandise and Fast-Moving Consumer Goods (like Yogurt, Light Bulbs, Dish Soap, Utility Pants, Food Storage, etc.) and has been seen to be performing really well.

<a id='378c8820-af22-4f28-8110-a00e61e8aaf4'></a>

The Mean Absolute Percentage Error for the model, when validated against observed assortment changes for the aforementioned categories, was almost always in the range of 4% to 13%.

<a id='fa7a4c46-6fce-4cfb-8a46-ab1190b9cb53'></a>

## 5. CONCLUSION
The problem of demand transference is an important one for any retailer. Obviously, the retailer cannot keep on carrying the same assortment over time. Market trends as well as the item performance, will always compel him to offer his customers the best assortment so as to maximize sales and customer satisfaction. Hence, it is better off to know from beforehand the magnitude of demand transference or cannibalization, that might be experienced with regards to a particular change in his assortment. Having a good understanding of the different scenarios will surely let him plan better than his competitors, and establish his stand in the market.

<a id='99e9a8e2-2f1e-422a-b2c5-9c08e1fa193a'></a>

Wrong choice of item deletion, might have severe repercussions in the form of:
1. churning of customer base which were loyal to the deleted product; or
2. churning of customer base, due to unavailability of proper substitutes of the deleted product in the available assortment.

<a id='a3d9722d-dcb5-4292-8718-72d1e4587b0c'></a>

Similarly, wrong choice of item addition could also be detrimental in the form of the new item not attracting any incremental demand of its own, but is only cannibalizing the demand of the other available items in the assortment, thus not doing any significant good to the retailer.

<a id='ffcf153e-403d-4556-a0d1-d3eaafdd9bd5'></a>

This study has been aimed to help the retailer address these basic problems of assortment.

<a id='9359cdcc-99d1-4a2c-9f54-b9b13526cf3c'></a>

## 6. REFERENCES
Fishbein M, ed. (1967) *Attitude and Prediction of Behavior* (John Wiley & Sons, New York).
Fisher ML, Vaidyanathan R (2009) An Algorithm and Demand Estimation Procedure for Retail Assortment Optimization. The Wharton School, Philadelphia, Pennsylvania.
Goodall DW (1966) A new similarity index based on probability. *Biometrics* 22(4):882–907.

<a id='35994022-cd0b-4fbc-9dc7-ebb690ed392d'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753

<a id='3d9d06ff-7b5d-4d3d-bdf7-d269f5ed8cd1'></a>

Kök, G., M. L. Fisher. 2007. Demand Estimation and Assortment Optimization under
Substitution: Methodology and Application. Operations Research 55(6) 1001–1021.
Lancaster K (1971) Consumer Demand: A New Approach (Columbia University Press, New
York).

<a id='b777cb94-f5b5-43a3-ad2c-bc8f5432aaa0'></a>

Rooderkerk RP, van Heerde HJ, Bijmolt TH (2011) Optimizing Retail Assortments. *Marketing Science* 32(5):699–715.

<a id='defdfde7-d2be-4063-bc99-89c975864a76'></a>

Wittink DR, Addona MJ, Hawkes W, Porter JC (1988) SCAN*PRO:The estimation, validation, and use of promotional effects based on scanner data. Working paper, Cornell University, Ithaca, NY.

<a id='a152a36f-b105-4184-a347-fc3f377eabbe'></a>

Electronic copy available at: https://ssrn.com/abstract=3227753